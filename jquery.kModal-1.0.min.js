(function(a){var b,c={init:function(c){b=a.extend({"mask-color":"#000","mask-opacity":.3,"mask-z-index":10,attachment:"center","close-esc":1,"close-mask":1,"close-button":0,"bind-link":1,"fade-time":500,"modal-z-index":11},c);a('<div id="kmodal_mask"></div>').appendTo("body");a("#kmodal_mask").css({background:b["mask-color"],position:"fixed",top:0,left:0,right:0,bottom:0,"z-index":b["mask-z-index"],display:"none"});b["bind-link"]&&a("a[kmodal=1]").live("click",function(b){b.preventDefault();var c=a(this).attr("href");a(c).kModal("show")});b["close-button"]&&a(".kmodal .close").click(function(b){b.preventDefault();a(".kmodal").each(function(){a(this).kModal("hide")})});b["close-mask"]&&a("#kmodal_mask").click(function(b){b.preventDefault();a(".kmodal").each(function(){a(this).kModal("hide")})});b["close-esc"]&&a(document).keyup(function(b){b.preventDefault();b.keyCode==27&&a(".kmodal").each(function(){a(this).kModal("hide")})})},show:function(c){a(this).kModal("resize");a(this).addClass("kmodal");a("#kmodal_mask").fadeTo(b["fade-time"],b["mask-opacity"]);a(this).fadeIn(b["fade-time"]);a(this).resize(function(){a(this).kModal("resize")})},hide:function(c){a("#kmodal_mask").fadeOut(b["fade-time"]);a(this).fadeOut(b["fade-time"])},resize:function(c){var d=a(document).height(),e=a(window).width(),f=a(window).height(),g=a(this).width(),h=a(this).height(),i={top:f/2-h/2,left:e/2-g/2};a("#kmodal_mask").css({width:e,height:d});a(this).css("position","fixed");a(this).animate(i,b["fade-time"]);a(this).css("z-index",b["modal-z-index"]);return i}};a.fn.kModal=function(b){if(c[b])return c[b].apply(this,Array.prototype.slice.call(arguments,1));if(typeof b=="object"||!b)return c.init.apply(this,arguments);a.error("Method "+b+" does not exist on jQuery.kModal")}})(jQuery);